Selenium is a tool that uses normal browsers to do testing of websites, but it also can be used for scraping.

The bookingApiSelenium.js uses Chromium to get booking XLSX files, download booking details and credit card details.
This solution already works with a local gui and a local database.

Chromium v59 above supports headless mode, so can be used on server. 

Chrome installs to /opt/google/chrome-unstable/chrome
Chromium instlls to /usr/lib/chromium


INSTALLATION

  1. //Use npm package manager to install selenium
   npm install selenium-webdriver
   "selenium-webdriver": "^3.4.0",


  2. Chrome driver
     https://sites.google.com/a/chromium.org/chromedriver/
     chromedriver      in terminal, shows 2.29
     in package.json:  "chromedriver": "^2.29.0",
      
    Chrome v60 itself does not work. This gets errors: https://stackoverflow.com/questions/43982934/selenium-webdriverjs-javascript-with-chrome
          https://github.com/SeleniumHQ/selenium/issues/3070


  3. Firefox:   
    yaourt -S geckodriver   
    installs selenium driver for firefox.
    https://github.com/mozilla/geckodriver/issues/683

    selenium has some issue with TEXT vs string that does not allow the scraping. This should be fixed soon.




ALTERNATIVES

1. Run on machine with gui; connect to remote database.

2. compile Chromium 59, or wait for Chromium 59 to go from beta to production.

3. Install Chrome, and get Selenium to work with Chrome.

4. Use xvfb

5. Use Selenium only to get the tokens; and then use CURL to downlod XLSX and ReservationDetails.





